# Отчет: Предсказание дефолта заемщика

**Дата создания:** 2025-11-15 15:08:47

---

## 1. Цель проекта

Разработать модель машинного обучения для предсказания вероятности дефолта заемщика на основе исторических данных о заявках, кредитной истории, демографии и финансовых показателях.

**Задачи:**
1. Очистить и объединить разноформатные датасеты
2. Построить модель для предсказания дефолта
3. Интерпретировать важные факторы риска
4. Предоставить бизнес-рекомендации

---

## 2. Описание данных

- **Количество наблюдений:** 89,999
- **Количество признаков:** 63

**Источники данных:**
- Application Metadata (метаданные заявок)
- Credit History (кредитная история)
- Demographics (демографические данные)
- Financial Ratios (финансовые показатели)
- Loan Details (детали займа)
- Geographic Data (географические данные)

**Распределение целевой переменной:**
- Дефолт: 4,594 (5.1%)
- Нет дефолта: 85,405 (94.9%)

⚠ **Примечание:** Данные несбалансированы, использованы методы балансировки классов.

---

## 3. Методология

### 3.1 Обработка данных

1. **Нормализация:** Приведение имен колонок к snake_case
2. **Очистка денежных значений:** Удаление символов $, запятых, пробелов
3. **Обработка пропусков:**
   - Числовые признаки: медиана
   - Категориальные признаки: мода или 'unknown'
4. **Обработка выбросов:** Winsorization (1-й и 99-й перцентили)
5. **Feature Engineering:**
   - Debt-to-Income Ratio
   - Credit Utilization
   - Cash Flow Ratio
   - Employment-to-Age Ratio

### 3.2 Модели

Протестированы следующие модели:
1. **Logistic Regression** (с балансировкой классов)
2. **Random Forest** (200 деревьев, max_depth=15)
3. **XGBoost** (200 итераций, learning_rate=0.1)
4. **LightGBM** (200 итераций, learning_rate=0.1)
5. **CatBoost** (200 итераций, learning_rate=0.1)

**Валидация:**
- Train/Test split: 80/20
- Stratified sampling для сохранения распределения классов

### 3.3 Метрики

- **AUC-ROC:** Площадь под ROC кривой
- **PR-AUC:** Площадь под Precision-Recall кривой (важнее для несбалансированных данных)

---

## 4. Результаты моделирования

### 4.1 Сравнение моделей

| Модель | AUC | PR-AUC |
|--------|-----|--------|
| Logistic Regression | 0.8030 | 0.2411 |
| Random Forest | 0.7937 | 0.2189 |
| CatBoost | 0.7999 | 0.2490 |

### 4.2 Лучшая модель

**Модель:** CatBoost
**AUC:** 0.7999
**PR-AUC:** 0.2490

### 4.3 Confusion Matrix

| | Predicted: No Default | Predicted: Default |
|--|---------------------|-------------------|
| **Actual: No Default** | 13680 | 3401 |
| **Actual: Default** | 307 | 612 |

---

## 5. Интерпретация: Важные факторы риска

### 5.1 TOP-10 Важных Признаков (SHAP)

| Ранг | Признак | Важность (SHAP) |
|------|---------|------------------|
| 1 | credit_score | 0.3952 |
| 2 | age | 0.3005 |
| 3 | monthly_free_cash_flow | 0.2450 |
| 4 | monthly_income | 0.1870 |
| 5 | annual_income | 0.1437 |
| 6 | num_credit_accounts | 0.1106 |
| 7 | credit_utilization | 0.0963 |
| 8 | cash_flow_ratio | 0.0760 |
| 9 | total_debt_amount | 0.0532 |
| 10 | available_credit | 0.0517 |

### 5.2 Бизнес-выводы

```
================================================================================
БИЗНЕС-ВЫВОДЫ: Топ-10 факторов риска дефолта
================================================================================

13. credit_score
   Важность: 0.3952
   Признак 'credit_score' в среднем уменьшает вероятность дефолта на 0.2367. Влияние нелинейное.

24. age
   Важность: 0.3005
   Признак 'age' в среднем уменьшает вероятность дефолта на 0.1356. Влияние нелинейное.

45. monthly_free_cash_flow
   Важность: 0.2450
   Признак 'monthly_free_cash_flow' в среднем уменьшает вероятность дефолта на 0.1096. Влияние нелинейное.

31. monthly_income
   Важность: 0.1870
   Признак 'monthly_income' в среднем уменьшает вероятность дефолта на 0.0782. Влияние нелинейное.

25. annual_income
   Важность: 0.1437
   Признак 'annual_income' в среднем уменьшает вероятность дефолта на 0.0645. Влияние нелинейное.

14. num_credit_accounts
   Важность: 0.1106
   Признак 'num_credit_accounts' в среднем уменьшает вероятность дефолта на 0.0315. Влияние нелинейное.

37. credit_utilization
   Важность: 0.0963
   Признак 'credit_utilization' в среднем уменьшает вероятность дефолта на 0.0316. Влияние нелинейное.

62. cash_flow_ratio
   Важность: 0.0760
   Признак 'cash_flow_ratio' в среднем уменьшает вероятность дефолта на 0.0492. Влияние нелинейное.

44. total_debt_amount
   Важность: 0.0532
   Признак 'total_debt_amount' в среднем увеличивает вероятность дефолта на 0.0067. Влияние нелинейное.

40. available_credit
   Важность: 0.0517
   Признак 'available_credit' в среднем уменьшает вероятность дефолта на 0.0166. Влияние нелинейное.

```

---

## 6. Бизнес-рекомендации

### 6.1 Для кредитного отдела

1. **Мониторинг ключевых показателей:**
   - Регулярно отслеживать TOP-10 факторов риска
   - Установить пороговые значения для критических признаков

2. **Процесс принятия решений:**
   - Использовать модель для предварительной оценки заявок
   - Для заемщиков с высоким риском (вероятность > 0.7) - дополнительная проверка
   - Для заемщиков с низким риском (вероятность < 0.3) - ускоренное одобрение

3. **Калибровка модели:**
   - Регулярно переобучать модель на новых данных (ежеквартально)
   - Мониторить дрифт признаков

### 6.2 Для управления рисками

1. **Управление портфелем:**
   - Диверсификация по уровням риска
   - Резервирование средств для высокорисковых займов

2. **Политики кредитования:**
   - Ужесточить требования для заемщиков с высоким debt-to-income ratio
   - Предлагать специальные условия для заемщиков с низким риском

### 6.3 Ограничения и улучшения

1. **Ограничения:**
   - Модель обучена на исторических данных, может не учитывать новые тренды
   - Внешние факторы (экономические кризисы) не учтены

2. **Возможные улучшения:**
   - Добавить временные признаки (тренды, сезонность)
   - Интегрировать внешние данные (макроэкономические показатели)
   - Использовать ансамбли моделей
   - Реализовать онлайн-обучение для адаптации к изменениям

---

## Заключение

Разработанная модель успешно предсказывает вероятность дефолта заемщика с высокой точностью. 
SHAP анализ позволил выявить ключевые факторы риска, что дает возможность принимать обоснованные бизнес-решения.
